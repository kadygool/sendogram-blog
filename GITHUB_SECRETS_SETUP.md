# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

–ß—Ç–æ–±—ã GitHub Actions –º–æ–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—å –±–ª–æ–≥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã (credentials) –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

## –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ SSH –∫–ª—é—á —Å —Å–µ—Ä–≤–µ—Ä–∞

–ù–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ SSH –∫–ª—é—á
cat ~/.ssh/id_rsa

# –ï—Å–ª–∏ –∫–ª—é—á–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π
ssh-keygen -t rsa -b 4096 -C "github-actions-deploy" -f ~/.ssh/github_deploy_key -N ""

# –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ authorized_keys
cat ~/.ssh/github_deploy_key.pub >> ~/.ssh/authorized_keys

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (–ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è GitHub)
cat ~/.ssh/github_deploy_key
```

**–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –≤—ã–≤–æ–¥** (–≤–∫–ª—é—á–∞—è `-----BEGIN RSA PRIVATE KEY-----` –∏ `-----END RSA PRIVATE KEY-----`)

## –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/kadygool/sendogram-blog
2. –ù–∞–∂–º–∏—Ç–µ **Settings** (–≤ –≤–µ—Ä—Ö–Ω–µ–º –º–µ–Ω—é)
3. –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **Secrets and variables** ‚Üí **Actions**
4. –ù–∞–∂–º–∏—Ç–µ **New repository secret**

### –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã:

#### `SERVER_HOST`
- **Name:** `SERVER_HOST`
- **Value:** IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `158.160.XXX.XXX`)

#### `SERVER_USER`
- **Name:** `SERVER_USER`
- **Value:** `admin17`

#### `SERVER_SSH_KEY`
- **Name:** `SERVER_SSH_KEY`
- **Value:** –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á (–≤–µ—Å—å —Ç–µ–∫—Å—Ç –∏–∑ `cat ~/.ssh/github_deploy_key`)

#### `SERVER_PORT` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Name:** `SERVER_PORT`
- **Value:** `22` (–∏–ª–∏ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç SSH, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω)

## –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions** –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
2. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å workflow "Deploy Blog to Server"
3. –ù–∞–∂–º–∏—Ç–µ **Run workflow** ‚Üí **Run workflow** –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞–π—Ç–µ –ª—é–±–æ–π –∫–æ–º–º–∏—Ç –≤ `main` –≤–µ—Ç–∫—É ‚Äî –¥–µ–ø–ª–æ–π –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—Ç–∞—Ç—å—è –ø–æ—è–≤–∏–ª–∞—Å—å
curl -I https://blog.sendogram.online/blog/rasylka-v-telegram/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ sitemap
curl https://blog.sendogram.online/sitemap.xml | grep rasylka

# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
open https://blog.sendogram.online/
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –í—ã –ø—É–±–ª–∏–∫—É–µ—Ç–µ —Å—Ç–∞—Ç—å—é –≤ Decap CMS
2. Decap —Å–æ–∑–¥–∞–µ—Ç Pull Request –≤ GitHub (—Ä–µ–∂–∏–º `editorial_workflow`)
3. –í—ã –º–µ—Ä–∂–∏—Ç–µ PR –≤ `main` –≤–µ—Ç–∫—É
4. GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
   - –ü–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ GitHub
   - –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–ª–æ–≥–∞
5. –°—Ç–∞—Ç—å—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ! üéâ

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –†–µ–∂–∏–º Simple (–±–µ–∑ PR)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —Å—Ç–∞—Ç—å–∏ –ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏—Å—å —Å—Ä–∞–∑—É –±–µ–∑ PR, –∏–∑–º–µ–Ω–∏—Ç–µ –≤ `public/admin/config.yml`:

```yaml
# –ë—ã–ª–æ:
publish_mode: editorial_workflow

# –°—Ç–∞–Ω–µ—Ç:
publish_mode: simple
```

–¢–æ–≥–¥–∞ —Å—Ç–∞—Ç—å–∏ –±—É–¥—É—Ç –∫–æ–º–º–∏—Ç–∏—Ç—å—Å—è —Å—Ä–∞–∑—É –≤ `main` –∏ –¥–µ–ø–ª–æ–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## Troubleshooting

### –û—à–∏–±–∫–∞: "Permission denied (publickey)"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ `~/.ssh/authorized_keys` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cat ~/.ssh/github_deploy_key.pub >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
```

### –û—à–∏–±–∫–∞: "docker: command not found"

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Docker –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `admin17`:

```bash
sudo usermod -aG docker admin17
```

### Workflow –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ Settings ‚Üí Secrets and variables ‚Üí Actions.

